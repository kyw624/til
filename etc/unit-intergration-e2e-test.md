# 테스트

## 요약

아래 그림처럼  
작은 단위의 테스트일수록 빠르고 비용이 적게 드는 반면에,  
단위가 커질수록 반대로 느리고 비용이 많이 든다.

![Test Pyramid](https://miro.medium.com/v2/resize:fit:828/format:webp/1*Tcj3OsK8Kou7tCMQgeeCuw.png)

> Test Pyramid (출처: https://betterprogramming.pub/the-test-pyramid-80d77535573)

<br>

## 1. 단위 테스트 (Unit Test)

> 소스 코드에서 작은 단위의 특정 모듈(기능)이 의도된대로 정확히 작동하는지 검증하는 절차.
> 즉, 모든 함수와 메서드에 대한 테스트 케이스를 작성하는 절차.

### 단위 테스트 원칙 (FIRST)

- **`Fast`**: 빨라야 한다.
- **`Isolated`**: 다른 테스트에 종속적인 테스트는 절대로 작성하지 않는다.
- **`Repeatable`**: 테스트는 실행할 때마다 같은 결과를 만들어야 한다.
- **`Self-validating`**: 테스트는 스스로 결과물이 옳은지 그른지 판단할 수 있어야 한다.
  특정 상태를 수동으로 미리 만들어야 동작하는 테스트 등은 작성하지 않는다.
- **`Timely`**: 프로덕션 코드가 테스트를 성공하기 직전에 구성되어야 한다.
  테스트 주도 개발(TDD) 방법론에 적합한 원칙이지만 실제로 적용되지 않는 경우도 있다.

### 장점

#### - 재빠른 문제점 발견 및 프로그램 안전성 향상

프로그램을 작은 단위로 쪼개서 각 단위가 정확하게 작동하는지 검사 후  
이를 통해 문제 발생 시 해당 부분을 재빨리 확인할 수 있어  
프로그램의 안정성 향상 및 디버깅 시간 단축의 효과가 있다.

#### - 변경이 쉽다.

개발자는 언제든지 테스트를 믿고 리팩터링할 수 있고  
이후에도 유닛 테스트를 통해 의도된대로 작동하는지 확신할 수 있다.

#### - 통합이 간단하다.

유닛 자체의 불확실성을 제거해주므로 bottom-up 테스트 방식에서 유용한데,  
더 나아가 이 검증된 유닛들을 합쳐 다시 검증하는 **통합 테스트**에서 더욱 빛을 발한다.

```js
// 테스트 예시

export const add = (x, y) => x + y;

describe('add', () => {
  test('두 수를 더하는 함수', () => {
    expect(1, 2).toBe(3);
    expect(4, 2).toBe(6);
  });
});
```

<br>

## 2. 통합 테스트 (Integration Test)

> 단위 테스트가 끝난 모듈들을 결합해 계획에 따라 테스트하는 방식.  
> 개발자가 변경할 수 없는 부분인 외부 라이브러리 등을 묶어 검증할때 사용된다.

### 장점

#### - 단위 테스트에서 발견하기 어려운 버그를 찾을 수 있음

예를 들면 환경 버그 등이 있다.

> ex) 싱글코어 CPU에서는 잘 돌아가지만 쿼드코어 CPU에서는 잘 안돌아가는 버그

### 단점

#### - 단위 테스트보다 신뢰성이 떨어질 수 있음

#### - 문제 발생 지점 찾기가 쉽지않음

<br>

## 3. E2E 테스트 (End-To-End Test)

> 모듈 단위가 아닌 사용자 관점에서 실제 사용자 시나리오를 테스트해 애플리케이션 자체의 무결성을 증명하는 테스트.

### 장점

#### - 실제 서비스 상황에서의 에러 검출이 가능

#### - 브라우저를 사용하기 때문에 Web API 활용 가능

#### - 테스트 코드가 내부 구조의 영향을 받지 않아 코드 변경에 비교적 덜 민감함

### 단점

#### - 단위, 통합 테스트에 비해 느리고 비용이 많이듬

#### - 테스트 실행 환경의 문제들 (네트워크 에러 등)로 인해 결과를 신뢰하기 어려움
